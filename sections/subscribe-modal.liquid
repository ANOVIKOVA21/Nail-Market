{{ 'subscribe-modal.css' | asset_url | stylesheet_tag }}
<dialog class="subscribe-modal" closedby="any">
  <div class="subscribe-modal__container">
    {% form 'customer', class: 'subscribe-form' %}
      <input type="hidden" name="contact[tags]" value="newsletter">
      <h2 class="subscribe-title">{{ 'general.modal.discount' | t }}</h2>
      <p class="subscribe-subtitle">{{ 'general.modal.subscribing_newsletter' | t }}</p>
      <input
        type="email"
        name="contact[email]"
        class="subscribe-email"
        placeholder="{{ 'general.modal.enter_email' | t }}"
        value="{{ form.email }}"
        aria-required="true"
        autocorrect="off"
        autocapitalize="off"
        autocomplete="email"
        required
      >
      <button
        type="submit"
        class="subscribe-btn button button-dark"
        name="commit"
        id="Subscribe"
        aria-label="{{ 'newsletter.button_label' | t }}"
      >
        {{ 'general.modal.subscribe' | t }}
      </button>
      <p class="subscribe-agreement">{{ 'general.modal.agreement' | t }}</p>
      {%- if form.errors -%}
        <small class="newsletter-form__message form__message" id="Newsletter-error--{{ section.id }}">
          <span class="svg-wrapper">
            {{- 'icon-error.svg' | inline_asset_content -}}
          </span>
          {{- form.errors.translated_fields.email | capitalize }}
          {{ form.errors.messages.email -}}
        </small>
      {%- endif -%}
      {%- if form.posted_successfully? -%}
        <h3
          class="newsletter-form__message newsletter-form__message--success form__message"
          id="Newsletter-success--{{ section.id }}"
          tabindex="-1"
          autofocus
        >
          <span class="svg-wrapper">
            {{- 'icon-success.svg' | inline_asset_content -}}
          </span>
          {{- 'newsletter.success' | t }}
        </h3>
      {%- endif -%}
    {% endform %}
    <div class="subscribe-img__container">
      <img
        src="https://cdn.shopify.com/s/files/1/0701/4177/1931/files/474905a450c6e9f90e495bd0d97dc8e13aba3431.png?v=1750206055"
        width="544"
        height="434"
        class="subscribe-img"
      >
    </div>
    <button
      class="button-close button button--tertiary"
      type="button"
      aria-label="{{ 'accessibility.close' | t }}"
      onclick="this.closest('dialog').close()"
    >
      <span class="svg-wrapper">
        {{- 'icon-close.svg' | inline_asset_content -}}
      </span>
    </button>
  </div>
</dialog>
<script>
  document.addEventListener('DOMContentLoaded', function () {
    if (!localStorage.getItem('subscribeModalShown')) {
      const dialog = document.querySelector('.subscribe-modal');
      if (dialog && typeof dialog.showModal === 'function') {
        dialog.showModal();
        localStorage.setItem('subscribeModalShown', 'true');
      }
    }
  });
</script>

{% schema %}
{
  "name": "Subscribe Modal",
  "tag": "section",
  "settings": [
    {
      "type": "article",
      "id": "modal",
      "label": "t:sections.featured-product.settings.product.label"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "t:sections.all.colors.label",
      "default": "scheme-1"
    }
  ],
  "presets": [
    {
      "name": "Subscribe Modal"
    }
  ]
}
{% endschema %}
